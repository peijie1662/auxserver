<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="UTF-8"/>
    <title>4G语音历史查询</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>

    <!-- Le styles -->
    <link href="../resources/js/js/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen"/>
    <link href="../resources/js/js/datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen"/>
    <style>
        body {
            padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */


        }

        .gcd-side {
            position: fixed;
            _position: absolute;
            right: 15px;
            bottom: 50px;
            z-index: 100000;
        }

        .gcd-side li {
            list-style-type:none;
            position: relative;
            padding: 8px 0;
            margin-bottom: 8px;
            margin-left: 8px;
            width: 55px;
            height: 55px;
            -webkit-transform: translateZ(0);



        }
        .gcd-side a span {

            font-size: 20px;
            color: #959595;
        }

    </style>
    <link href="../resources/js/js/bootstrap/css/bootstrap-responsive.css" rel="stylesheet"/>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="../resources/js/js/html5shiv.min.js"></script>
    <script src="../resources/js/js/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="../resources/js/js/dewplayer/swfobject.js"></script>
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="brand" href="#"></a>

        </div>
    </div>
</div>
<div class="container-fluid">

        <div class="span12">
            <div class="well" >
                <div class="row-fluid" >
                    <div class="span3" style="height: 65px">
                        <label class="control-label">开始时间</label>

                        <div class="controls input-append date form_date" data-date="" data-date-format="yyyymmdd"
                             data-link-field="dtp_Start" data-link-format="yyyymmdd">
                            <input size="16" type="text" value="" />
                            <span class="add-on"><i class="icon-remove"></i></span>
                            <span class="add-on"><i class="icon-th"></i></span>
                        </div>
                        <input type="hidden" id="dtp_Start" value=""/>
                    </div>
                    <div class="span3"  style="height: 65px">
                        <label class="control-label">结束时间</label>

                        <div class="controls input-append date form_date" data-date="" data-date-format="yyyymmdd"
                             data-link-field="dtp_End" data-link-format="yyyymmdd">
                            <input size="16" type="text" value=""/>
                            <span class="add-on"><i class="icon-remove"></i></span>
                            <span class="add-on"><i class="icon-th"></i></span>
                        </div>
                        <input type="hidden" id="dtp_End" value=""/>

                    </div>
                    <div class="span1" style="height: 65px">
                        <br/>
                        <button class="btn btn-primary" type="button" style="margin-top: 5px"  onclick="getData();" >查&nbsp;&nbsp;&nbsp;询</button>
                    </div>


                </div>
            </div>
            <div class="well">
                <div class="row" style="padding-top: 60px">
                    <table class="table table-bordered" style="margin-left: 15px;">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>发送用户</th>
                            <th>发送机器号</th>
                            <th>接收用户</th>
                            <th>接收机器号</th>
                            <th>发送时间</th>
                            <th>已接收</th>
                            <th>语音</th>
                        </tr>
                        </thead>
                        <tbody id="tbVoice">

                        </tbody>
                    </table>
                </div>
            </div>
        </div>

</div>

<div class="gcd-side" style="display: block">
        <li class="gotop" style="display: block;">
            <a trace="toolBarTohead" href="#top" style="width: 55px">
                <span class="icon-arrow-up" >
                    <br/><p style="font-size: 8px;width: 100%">回到顶部</p></span>

            </a>
        </li>
        
</div>
<script type="text/javascript" src="../resources/js/js/jquery-1.8.3.min.js" charset="utf-8"></script>
<script type="text/javascript" src="../resources/js/js/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../resources/js/js/datetimepicker/js/bootstrap-datetimepicker.js" charset="utf-8"></script>
<script type="text/javascript" src="../resources/js/js/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"
        charset="utf-8"></script>

<script type="text/javascript">

    $('.form_date').datetimepicker({
        language: 'zh-CN',
        weekStart: 1,
        todayBtn: 1,
        autoclose: 1,
        todayHighlight: 1,
        startView: 2,
        minView: 2,
        forceParse: 0
    });
    function setPlayer(voiceName){
       var str;
        str = '<object data="../resources/js/js/dewplayer/dewplayer-vol.swf" width="240" height="20" name="dewplayer" id="dewplayer" type="application/x-shockwave-flash">'
            + '<param name="movie" value="../resources/js/js/dewplayer/dewplayer-vol.swf" /> '
            + '<param name="flashvars" value="mp3=/auxserver/mp3/' + voiceName + '.mp3" /> '
            + '<param name="wmode" value="transparent" /> '
            + '</object>';
        return str;

    }
    function getData(){
        var dateStart,dateEnd,tb,i;

        dateStart = $('#dtp_Start').val();
        dateEnd = $('#dtp_End').val();
       // if ((dateStart == '') || (dateEnd == ''))
      //  {
      //      alert('时间相同');
     //       return;
     //   }
       // if (dateStart < dateEnd){
       //     alert('结束时间大于开始时间')
       //     return;
      //  }
        //alert(setPlayer('aaa'));
        tb = '';
        i = 1;
        $.ajax({
            type: "POST",
            url: "/auxserver/voice/begin/"+ dateStart +"/end/" + dateEnd,
            jsonp:"jsoncallback",
            //contentType: "application/json;charset=gb2312",
            dataType: 'json',
            success: function (json) {
                $("#tbVoice").empty();
                $.each(json,function(n,value){
                    tb = tb + '<tr>'
                            + '<td>' + i + '</td>'
                            + '<td>' + value.srcName + '</td>'
                            + '<td>' + value.srcMac + '</td>'
                            + '<td>' + value.targetName + '</td>'
                            + '<td>' + value.targetMac + '</td>'
                            + '<td>' + value.crtTime + '</td>'
                            + '<td>' + value.received + '</td>'
                            + '<td>' + setPlayer(value.fileName) + '</td>'
                            + '</tr>';
                    i = i + 1;
                });
                $('#tbVoice').append(tb);
            }
        });
    }

</script>

</body>
</html>